FROM {{ image_name|default("rhel7") }}
RUN curl https://bootstrap.pypa.io/get-pip.py | python
RUN pip install tox
RUN yum install -y http://rhos-release.virt.bos.redhat.com/repos/rhos-release/rhos-release-latest.noarch.rpm
RUN rhos-release 15
RUN yum-config-manager --enable rhelosp-15.0-unittest
RUN yum install python-devel git gcc -y
RUN git -c http.sslVerify=false clone {{ args['gerrit']|default(args['git']) }}/{{ args['project'] }}.git
ENV TEST_ENV {{ args['tester'] }}
RUN cd {{ args['project'] }} && git checkout rhos-{{ args['release'] }}.0-patches && tox -e py $TEST_ENV
